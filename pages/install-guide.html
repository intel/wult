<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Wult - Install Guide</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"/>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda"/>
        <link rel="stylesheet" type="text/css" href="https://intel.github.io/wult/theme/css/main.css"/>
</head>
<body>
<style>.github-corner:hover .octo-arm {
    animation: octocat-wave 560ms ease-in-out
}
@keyframes octocat-wave {
    0%, 100% {
        transform: rotate(0)
    }
    20%, 60% {
        transform: rotate(-25deg)
    }
    40%, 80% {
        transform: rotate(10deg)
    }
}
@media (max-width: 500px) {
    .github-corner:hover .octo-arm {
        animation: none
    }

    .github-corner .octo-arm {
        animation: octocat-wave 560ms ease-in-out
    }
}</style><div id="container">
    <header>
        <h1><a href="https://intel.github.io/wult/">Wult</a></h1>
        <p><em></em></p>
    </header>
    <nav>
        <ul>
                <li><a href="/wult/pages/how-it-works.html">How it works</a></li>
                <li><a href="/wult/pages/install-guide.html">Install</a></li>
                <li><a href="/wult/pages/user-guide.html">Use</a></li>
                <li><a href="/wult/pages/howto.html">Howto</a></li>
                <li><a href="/wult/pages/ndl.html">Ndl</a></li>
        </ul>
    </nav>
    <main>
        <section>
            <h1>Install Guide</h1>
            
            <!-- -*- coding: utf-8 -*- -->
<!-- vim: ts=4 sw=4 tw=100 et ai si -->
<div class="contents topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#standard-case-local-usage-model" id="toc-entry-1">1 Standard case (local usage model)</a><ul>
<li><a class="reference internal" href="#update" id="toc-entry-2">1.1 Update</a></li>
<li><a class="reference internal" href="#sut-root-access" id="toc-entry-3">1.2 SUT root access</a></li>
<li><a class="reference internal" href="#install-dependencies" id="toc-entry-4">1.3 Install dependencies</a><ul>
<li><a class="reference internal" href="#kernel-sources-1" id="toc-entry-5">1.3.1 Kernel sources</a></li>
<li><a class="reference internal" href="#os-packages-1" id="toc-entry-6">1.3.2 OS packages</a></li>
</ul>
</li>
<li><a class="reference internal" href="#install-pepc" id="toc-entry-7">1.4 Install pepc</a></li>
<li><a class="reference internal" href="#install-wult" id="toc-entry-8">1.5 Install wult</a></li>
<li><a class="reference internal" href="#deploy-wult-drivers" id="toc-entry-9">1.6 Deploy wult drivers</a></li>
<li><a class="reference internal" href="#tab-completions" id="toc-entry-10">1.7 Tab completions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#non-standard-case-remote-usage-model" id="toc-entry-11">2 Non-standard case (remote usage model)</a><ul>
<li><a class="reference internal" href="#update-1" id="toc-entry-12">2.1 Update</a></li>
<li><a class="reference internal" href="#passwordless-sut-login" id="toc-entry-13">2.2 Passwordless SUT login</a></li>
<li><a class="reference internal" href="#install-dependencies-1" id="toc-entry-14">2.3 Install dependencies</a><ul>
<li><a class="reference internal" href="#kernel-sources-2" id="toc-entry-15">2.3.1 Kernel sources</a></li>
<li><a class="reference internal" href="#os-packages-2" id="toc-entry-16">2.3.2 OS packages</a></li>
</ul>
</li>
<li><a class="reference internal" href="#install-pepc-and-wult" id="toc-entry-17">2.4 Install pepc and wult</a></li>
<li><a class="reference internal" href="#deploy-wult-drivers-1" id="toc-entry-18">1.6 Deploy wult drivers</a></li>
</ul>
</li>
</ul>
</div>
<p><em>Wult</em> is a Python 3 project, but it comes with kernel drivers. Therefore, the basic installation
sequence is:</p>
<ol class="arabic simple">
<li>Install <em>wult</em> with its dependencies (kernel sources, <cite>pepc</cite>, OS packages)</li>
<li>Deploy <em>wult</em> drivers</li>
</ol>
<p><strong>Important</strong>: <em>Wult</em> is a research and debug tool, it loads its own drivers and requires root
privileges. Do not use it on a production system, use it only in a lab environment.</p>
<p><em>Wult</em> installation procedure will vary a little bit depending on whether you prefer the local or
remote usage models (<a class="reference external" href="user-guide.html#usage-models">details here</a>).</p>
<div class="section" id="standard-case-local-usage-model">
<h2><a class="toc-backref" href="#toc-entry-1">1 Standard case (local usage model)</a></h2>
<p>In the (<a class="reference external" href="user-guide.html#local-usage-model">local usage model</a>):</p>
<ul class="simple">
<li><em>wult</em> is installed on the SUT (System Under Test)</li>
<li>drivers are deployed to the SUT</li>
<li><em>wult</em> measures the SUT and stores the results on the SUT</li>
</ul>
<div class="section" id="update">
<h3><a class="toc-backref" href="#toc-entry-2">1.1 Update</a></h3>
<p>Before describing the installation steps, here is a how you update an existing wult
installation.</p>
<pre class="literal-block">
pip3 install --user --upgrade git+https://github.com/intel/pepc.git&#64;release
pip3 install --user --upgrade git+https://github.com/intel/wult.git&#64;release
sudo wult deploy
</pre>
</div>
<div class="section" id="sut-root-access">
<h3><a class="toc-backref" href="#toc-entry-3">1.2 SUT root access</a></h3>
<p>Make sure you have root or <cite>sudo</cite> permissions on the SUT.</p>
</div>
<div class="section" id="install-dependencies">
<h3><a class="toc-backref" href="#toc-entry-4">1.3 Install dependencies</a></h3>
<p><em>Wult</em> has several dependencies. First of all, the sources of the running kernel must be installed
on the SUT. Not just kernel headers for user-space programs, but full kernel source code.</p>
<p>Wult also requires <a class="reference external" href="https://github.com/intel/pepc">pepc</a> to be installed.
You'll also need the tools necessary for compiling kernel drivers on the SUT: <cite>gcc</cite>, <cite>make</cite>, etc.</p>
<p>In addition to this, <em>wult</em> requires various python packages.</p>
<div class="section" id="kernel-sources-1">
<span id="kernel-sources"></span><h4><a class="toc-backref" href="#toc-entry-5">1.3.1 Kernel sources</a></h4>
<p><em>Wult</em> comes with kernel drivers which have to be built for the kernel running on the SUT.</p>
<p>On Fedora and Ubuntu, the sources are typically located in <tt class="docutils literal"><span class="pre">/lib/modules/&lt;kernel_version&gt;/build</span></tt>.
The <cite>&lt;kernel_version&gt;</cite> part must match the kernel running on the SUT. In other words, it has to be
the same as what the <cite>uname -r</cite> command prints when you run it on the SUT.</p>
<p>Unless you are an advanced user, you probably run a stock OS kernel. In this case, it is
enough to just install the kernel sources package provided by the OS, e.g.:</p>
<ul class="simple">
<li>Fedora: <cite>kernel-devel</cite> package</li>
<li>Ubuntu: <cite>linux-source</cite> package</li>
</ul>
<p>Advanced users can provide custom kernel sources path via <cite>wult deploy</cite> command line options (see
the <a class="reference external" href="https://github.com/intel/wult/blob/master/docs/wult-man.rst">wult man page</a>).</p>
</div>
<div class="section" id="os-packages-1">
<span id="os-packages"></span><h4><a class="toc-backref" href="#toc-entry-6">1.3.2 OS packages</a></h4>
<p>Here are the required OS packages.</p>
<p><strong>Fedora</strong></p>
<pre class="literal-block">
sudo dnf install -y tar bison flex make gcc elfutils-libelf-devel rsync procps-ng
sudo dnf install -y libffi-devel redhat-rpm-config openssl-devel
sudo dnf install -y kernel-devel
sudo dnf install -y git python3 python3-devel python3-pip python3-numpy
sudo dnf install -y python3-colorama python3-yaml python3-pandas
sudo dnf install -y  python3-paramiko python3-argcomplete
</pre>
<p><strong>Ubuntu</strong></p>
<pre class="literal-block">
sudo apt install -y bison flex libelf-dev libssl-dev rsync procps
sudo apt-get source linux-source
sudo apt install -y git python3-pip python3-numpy python3-plotly
sudo apt install -y python3-colorama python3-yaml python3-pandas
sudo apt install -y python3-paramiko python3-argcomplete
</pre>
<p><strong>Notes</strong></p>
<ol class="arabic simple">
<li>If you do not install some of the python projects installing the corresponding <cite>python3-*</cite> OS
packages, they will be pulled by the <cite>pip</cite> tool later when you install <em>wult</em>. However, we
recommend installing <cite>numpy</cite> from OS packages, because it is optimized for the OS.</li>
<li>The <cite>git</cite> package is required to make it possible installing <em>wult</em> python projects directly from
their git repository (see below). Otherwise it is not necessary.</li>
</ol>
</div>
</div>
<div class="section" id="install-pepc">
<h3><a class="toc-backref" href="#toc-entry-7">1.4 Install pepc</a></h3>
<p><em>Wult</em> requires another Python3 project to be installed: <cite>pepc &lt;https://github.com/intel/pepc&gt;</cite>.
The <cite>pepc</cite> installation steps are provided in the next section.</p>
</div>
<div class="section" id="install-wult">
<h3><a class="toc-backref" href="#toc-entry-8">1.5 Install wult</a></h3>
<p><cite>Wult</cite> and <cite>pepc</cite> are python version 3 projects, and we recommend using the <cite>pip</cite> tool for
installing them. Here is how to install them directly from the <cite>release</cite> branch of their git
repositories:</p>
<pre class="literal-block">
pip3 install --user --upgrade git+https://github.com/intel/pepc.git&#64;release
pip3 install --user --upgrade git+https://github.com/intel/wult.git&#64;release
</pre>
</div>
<div class="section" id="deploy-wult-drivers">
<h3><a class="toc-backref" href="#toc-entry-9">1.6 Deploy wult drivers</a></h3>
<p>The final step is to build and deploy wult drivers. Run this command on the SUT as &quot;root&quot;.</p>
<pre class="literal-block">
sudo wult deploy
</pre>
<p><strong>Important note</strong></p>
<p>The drivers are installed only for the currently running kernel. If you reboot the SUT to a
different kernel, you have to re-run <cite>wult deploy</cite>.</p>
</div>
<div class="section" id="tab-completions">
<h3><a class="toc-backref" href="#toc-entry-10">1.7 Tab completions</a></h3>
<p><cite>Wult</cite> and <cite>pepc</cite> tools have bash tab completions support, but this will only work if you have
certain environment variables defined. The following commands will do it:</p>
<pre class="literal-block">
eval $(register-python-argcomplete wult)
eval $(register-python-argcomplete pepc)
</pre>
<p>You can put these lines to your <cite>.bashrc</cite> file in order to have <cite>wult</cite> and <cite>pepc</cite> tab completions
enabled by default.</p>
</div>
</div>
<div class="section" id="non-standard-case-remote-usage-model">
<h2><a class="toc-backref" href="#toc-entry-11">2 Non-standard case (remote usage model)</a></h2>
<p>In the (<a class="reference external" href="user-guide.html#remote-usage-model">remote usage model</a>):</p>
<ul class="simple">
<li><em>wult</em> is installed on the controller</li>
<li>drivers are deployed to the SUT</li>
<li><em>wult</em> measures the SUT and stores the results on the controller</li>
</ul>
<div class="section" id="update-1">
<h3><a class="toc-backref" href="#toc-entry-12">2.1 Update</a></h3>
<p>Before describing the installation steps, here is a how you update an existing wult
installation. Run the following commands on the controller:</p>
<pre class="literal-block">
pip3 install --user --upgrade git+https://github.com/intel/pepc.git&#64;release
pip3 install --user --upgrade git+https://github.com/intel/wult.git&#64;release
sudo wult deploy -H SUTNAME
</pre>
</div>
<div class="section" id="passwordless-sut-login">
<span id="passwordless-ssh"></span><h3><a class="toc-backref" href="#toc-entry-13">2.2 Passwordless SUT login</a></h3>
<p>In case of the remote usage model, you need to configure passwordless root SSH login from the
controller to the SUT. You are going to run <em>wult</em> as a regular user on the controller, but it will
SSH into the SUT as <cite>root</cite>. Please, use online documentation to find out how to do this for your
Linux distribution, but here is one way of doing this (worked on Fedora and Ubuntu).</p>
<p>Configure the SSH server on the SUT to allow for root login by enabling the &quot;PermitRootLogin&quot;
option. Then restart the SSH server.</p>
<pre class="literal-block">
sudo sh -c 'echo &quot;PermitRootLogin yes&quot; &gt;&gt; /etc/ssh/sshd_config'
sudo systemctl restart sshd
</pre>
<p>You'll need user SSH keys on the controller. If you do not have them, generate a new SSH key pair on
the controller. For example, this command (executed as under your user on the controller) will
generate a pair of RSA keys - &quot;sut&quot; (private key) and &quot;sut.pub&quot; (public key):</p>
<pre class="literal-block">
cd ~/.ssh
ssh-keygen -t rsa -f sut
</pre>
<p>And the last step is to configure the controller to use the &quot;~/.ssh/sut&quot; private key when
authenticating to the SUT. You can run something like this on the controller:</p>
<pre class="literal-block">
cat &lt;&lt;EOF &gt;&gt; ~/.ssh/config
Host SUTNAME
    IdentityFile ~/.ssh/sut
EOF
</pre>
<p>Now you should be able to log in to the SUT as root without typing the password. Test it by running
the following on the controller:</p>
<pre class="literal-block">
ssh root&#64;SUTNAME
</pre>
<p>If you still have issues, enable <cite>sshd</cite> debug level logs on the SUT, and check them out, they
usually give very good clues. Use <cite>ssh -v</cite> on the controller to get verbose messages, which also can
give some clues.</p>
</div>
<div class="section" id="install-dependencies-1">
<h3><a class="toc-backref" href="#toc-entry-14">2.3 Install dependencies</a></h3>
<p>Everything is the same as in the local usage mode, but some of the dependencies should be installed
on the controller instead of the SUT.</p>
<div class="section" id="kernel-sources-2">
<h4><a class="toc-backref" href="#toc-entry-15">2.3.1 Kernel sources</a></h4>
<p>Install them on the controller, same way as in the <a class="reference external" href="#os-packages">local usage model case</a>.</p>
</div>
<div class="section" id="os-packages-2">
<h4><a class="toc-backref" href="#toc-entry-16">2.3.2 OS packages</a></h4>
<p>Here are the required OS packages.</p>
<p><strong>Fedora</strong></p>
<p>SUT:</p>
<pre class="literal-block">
sudo dnf install -y tar bison flex make gcc elfutils-libelf-devel rsync
sudo dnf install -y libffi-devel redhat-rpm-config openssl-devel
sudo dnf install -y kernel-devel
</pre>
<p>Controller:</p>
<pre class="literal-block">
sudo dnf install -y git python3 python3-devel python3-pip python3-numpy
sudo dnf install -y python3-colorama python3-yaml python3-pandas
sudo dnf install -y  python3-paramiko rsync
</pre>
<p><strong>Ubuntu</strong></p>
<p>SUT:</p>
<pre class="literal-block">
sudo apt install -y bison flex libelf-dev libssl-dev
sudo apt-get source linux-source
</pre>
<p>Controller:</p>
<pre class="literal-block">
sudo apt install -y git python3-pip python3-numpy python3-plotly
sudo apt install -y python3-colorama python3-yaml python3-pandas
sudo apt install -y python3-paramiko rsync
</pre>
<p><strong>Notes</strong></p>
<p>Same as the <a class="reference external" href="#kernel-sources">local usage model notes</a>.</p>
</div>
</div>
<div class="section" id="install-pepc-and-wult">
<h3><a class="toc-backref" href="#toc-entry-17">2.4 Install pepc and wult</a></h3>
<p>Install them on the controller, same way as <a class="reference external" href="#install-pepc-wult">in the local usage model case</a>.</p>
</div>
<div class="section" id="deploy-wult-drivers-1">
<h3><a class="toc-backref" href="#toc-entry-18">1.6 Deploy wult drivers</a></h3>
<p>Make sure that <a class="reference external" href="#passwordless-ssh">passwordless</a> SUT access works, then run the following command
on the controller:</p>
<pre class="literal-block">
sudo wult deploy -H SUTNAME
</pre>
<p><strong>Important note</strong></p>
<p>The drivers are installed only for the currently running kernel. If you reboot the SUT to a
different kernel, you have to re-run <cite>wult deploy -H SUTNAME</cite> on the controller.</p>
</div>
</div>

        </section>
     </main>
    <footer>
        <h6>
            Rendered by <a href="http://getpelican.com/">Pelican</a> &nbsp;&bull;&nbsp; Theme by <a
                href="https://github.com/aleylara/Peli-Kiera">Peli-Kiera</a> &nbsp;&bull;&nbsp; Copyright
                &copy &nbsp;&#8209;&nbsp; Artem Bityutskiy         </h6>
    </footer>
</div>
</body>
</html>
