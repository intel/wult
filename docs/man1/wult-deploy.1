.\" Automatically generated by Pandoc 3.1.3
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "" "" "" "" ""
.hy
.SH WULT
.TP
Date
2024-03-08
.TP
Title
DEPLOY
.SH COMMAND \[aq]\f[I]wult\f[R] deploy\[aq]
.PP
usage: wult deploy [-h] [-q] [-d] [--kernel-src KSRC] [--rebuild-bpf]
[--local-build] [--tmpdir-path TMPDIR_PATH] [--keep-tmpdir] [-H
HOSTNAME] [-U USERNAME] [-K PRIVKEY] [-T TIMEOUT] [--skip-drivers]
.PP
Compile and deploy wult helpers and drivers to the SUT (System Under
Test), which can be can be either local or a remote host, depending on
the \[aq]-H\[aq] option.
By default, everything is built on the SUT, but the
\[aq]--local-build\[aq] can be used for building on the local system.
The drivers are searched for in the following directories (and in the
following order) on the local host: ./drivers/idle,
$WULT_DATA_PATH/drivers/idle, $HOME/.local/share/wult/drivers/idle,
/usr/local/share/wult/drivers/idle, /usr/share/wult/drivers/idle.
The wult tool also depends on the following helpers: wult-freq-helper,
wult-hrt-helper, wult-tdt-helper.
These helpers will be compiled on the SUT and deployed to the SUT.
The sources of the helpers are searched for in the following paths (and
in the following order) on the local host: ./helpers,
$WULT_DATA_PATH/helpers, $HOME/.local/share/wult/helpers,
/usr/local/share/wult/helpers, /usr/share/wult/helpers.
By default, helpers are deployed to the path defined by the
\[aq]WULT_HELPERSPATH\[aq] environment variable.
If the variable is not defined, helpers are deployed to
\[aq]$HOME/.local/bin\[aq], where \[aq]$HOME\[aq] is the home directory
of user \[aq]USERNAME\[aq] on host \[aq]HOST\[aq] (see \[aq]--host\[aq]
and \[aq]--username\[aq] options).
.SS OPTIONS \f[I]\[aq]wult\f[R] deploy\[aq]
.TP
\f[B]-h\f[R]
Show this help message and exit.
.TP
\f[B]-q\f[R]
Be quiet.
.TP
\f[B]-d\f[R]
Print debugging information.
.TP
\f[B]--kernel-src\f[R] \f[I]KSRC\f[R]
Path to the Linux kernel sources to build drivers and eBPF helpers
against.
The default is \[aq]/lib/modules/$(uname -r)/build\[aq] on the SUT.
If \[aq]--local-build\[aq] was used, then the path is considered to be
on the local system, rather than the SUT.
.TP
\f[B]--drivers-make-opts\f[R]
Options and variables to pass to \[aq]make\[aq] when the drivers are
built.
For example, pass \[aq]CC=clang LLVM=1\[aq] to use clang and LLVM tools
for building the drivers (required when the kernel was build with
clang/LLVM).
.TP
\f[B]--skip-drivers\f[R]
Deploy the eBPF helper, but do not deploy the drivers.
This is a debug and development option, do not use it for other
purposes.
.TP
\f[B]--rebuild-bpf\f[R]
eBPF helpers sources consist of 2 components: the user-space component
and the eBPF component.
The user-space component is distributed as a source code, and must be
compiled.
The eBPF component is distributed as both source code and in binary
(compiled) form.
By default, the eBPF component is not re-compiled.
This option is meant to be used by wult developers to re-compile the
eBPF component if it was modified.
.TP
\f[B]--local-build\f[R]
Build helpers and drivers locally, instead of building on HOSTNAME (the
SUT).
.TP
\f[B]--tmpdir-path\f[R] \f[I]TMPDIR_PATH\f[R]
When \[aq]wult\[aq] is deployed, a random temporary directory is used.
Use this option provide a custom path instead.
It will be used as a temporary directory on both local and remote hosts.
This option is meant for debugging purposes.
.TP
\f[B]--keep-tmpdir\f[R]
Do not remove the temporary directories created while deploying
\[aq]wult\[aq].
This option is meant for debugging purposes.
.TP
\f[B]-H\f[R] \f[I]HOSTNAME\f[R], \f[B]--host\f[R] \f[I]HOSTNAME\f[R]
Name of the host to run the command on.
.TP
\f[B]-U\f[R] \f[I]USERNAME\f[R], \f[B]--username\f[R] \f[I]USERNAME\f[R]
Name of the user to use for logging into the remote host over SSH.
The default user name is \[aq]root\[aq].
.TP
\f[B]-K\f[R] \f[I]PRIVKEY\f[R], \f[B]--priv-key\f[R] \f[I]PRIVKEY\f[R]
Path to the private SSH key that should be used for logging into the
remote host.
By default the key is automatically found from standard paths like
\[aq]\[ti]/.ssh\[aq].
.TP
\f[B]-T\f[R] \f[I]TIMEOUT\f[R], \f[B]--timeout\f[R] \f[I]TIMEOUT\f[R]
SSH connect timeout in seconds, default is 8.
