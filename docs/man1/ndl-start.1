.\" Automatically generated by Pandoc 3.1.3
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "" "" "" "" ""
.hy
.SH NDL
.TP
Date
2024-03-08
.SH COMMAND \f[I]\[aq]ndl\f[R] start\[aq]
.PP
usage: ndl start [-h] [-q] [-d] [-H HOSTNAME] [-U USERNAME] [-K PRIVKEY]
[-T TIMEOUT] [-c COUNT] [--time-limit LIMIT] [-o OUTDIR] [--reportid
REPORTID] [--stats STATS] [--stats-intervals STATS_INTERVALS]
[--list-stats] [-l LDIST] [--cpu CPU] [--exclude EXCLUDE]
[--include INCLUDE] [--keep-filtered] [--report] [--force]
[--trash-cpu-cache] [--freq-noise FREQ_NOISE] [--freq-noise-sleep
FREQ_NOISE_SLEEP] ifname
.PP
Start measuring and recording the latency data.
.TP
\f[B]ifname\f[R]
The network interface backed by the NIC to use for latency measurements.
Today only Intel I210 and I211 NICs are supported.
Please, specify NIC\[aq]s network interface name (e.g., eth0).
.SS OPTIONS \f[I]\[aq]ndl\f[R] start\[aq]
.TP
\f[B]-h\f[R]
Show this help message and exit.
.TP
\f[B]-q\f[R]
Be quiet.
.TP
\f[B]-d\f[R]
Print debugging information.
.TP
\f[B]-H\f[R] \f[I]HOSTNAME\f[R], \f[B]--host\f[R] \f[I]HOSTNAME\f[R]
Name of the host to run the command on.
.TP
\f[B]-U\f[R] \f[I]USERNAME\f[R], \f[B]--username\f[R] \f[I]USERNAME\f[R]
Name of the user to use for logging into the remote host over SSH.
The default user name is \[aq]root\[aq].
.TP
\f[B]-K\f[R] \f[I]PRIVKEY\f[R], \f[B]--priv-key\f[R] \f[I]PRIVKEY\f[R]
Path to the private SSH key that should be used for logging into the
remote host.
By default the key is automatically found from standard paths like
\[aq]\[ti]/.ssh\[aq].
.TP
\f[B]-T\f[R] \f[I]TIMEOUT\f[R], \f[B]--timeout\f[R] \f[I]TIMEOUT\f[R]
SSH connect timeout in seconds, default is 8.
.TP
\f[B]-c\f[R] \f[I]COUNT\f[R], \f[B]--datapoints\f[R] \f[I]COUNT\f[R]
How many datapoints should the test result include, default is 1000000.
Note, unless the \[aq]--start-over\[aq] option is used, the pre-existing
datapoints are taken into account.
For example, if the test result already has 6000 datapoints and memory.
.TP
\f[B]--time-limit\f[R] \f[I]LIMIT\f[R]
The measurement time limit, i.e., for how long the SUT should be
measured.
The default unit is minute, but you can use the following handy
specifiers as well: d - days, h - hours, m - minutes, s -seconds.
For example \[aq]1h25m\[aq] would be 1 hour and 25 minutes, or 10m5s
would be 10 minutes and 5 seconds.
Value \[aq]0\[aq] means \[dq]no time limit\[dq], and this is the
default.
If this option is used along with the \[aq]--datapoints\[aq] option,
then measurements will stop as when either the time limit is reached, or
the required amount of datapoints is collected.
.TP
\f[B]-o\f[R] \f[I]OUTDIR\f[R], \f[B]--outdir\f[R] \f[I]OUTDIR\f[R]
Path to the directory to store the results at.
.TP
\f[B]--reportid\f[R] \f[I]REPORTID\f[R]
Any string which may serve as an identifier of this run.
By default report ID is the current date, prefixed with the remote host
name in case the \[aq]-H\[aq] option was used: [hostname-]YYYYMMDD.
For example, \[dq]20150323\[dq] is a report ID for a run made on March
23, 2015.
The allowed characters are: ACSII alphanumeric, \[aq]-\[aq],
\[aq].\[aq], \[aq],\[aq], \[aq]_\[aq], \[aq]\[ti]\[aq], and \[aq]:\[aq].
.TP
\f[B]--stats\f[R] \f[I]STATS\f[R]
Comma-separated list of statistics to collect.
The statistics are collected in parallel with measuring C-state latency.
They are stored in the the \[dq]stats\[dq] sub-directory of the output
directory.
By default, only \[aq]turbostat, sysinfo\[aq] statistics are collected.
Use \[aq]all\[aq] to collect all possible statistics.
Use \[aq]--stats=\[dq]\[dq]\[aq] or \[aq]--stats=\[dq]none\[dq]\[aq] to
disable statistics collection.
If you know exactly what statistics you need, specify the
comma-separated list of statistics to collect.
For example, use \[aq]turbostat,acpower\[aq] if you need only turbostat
and AC power meter statistics.
You can also specify the statistics you do not want to be collected by
pre-pending the \[aq]!\[aq] symbol.
For example, \[aq]all,!turbostat\[aq] would mean: collect all the
statistics supported by the SUT, except for \[aq]turbostat\[aq].
Use the \[aq]--list-stats\[aq] option to get more information about
available statistics.
By default, only \[aq]sysinfo\[aq] statistics are collected.
.TP
\f[B]--stats-intervals\f[R] \f[I]STATS_INTERVALS\f[R]
The intervals for statistics.
Statistics collection is based on doing periodic snapshots of data.
For example, by default the \[aq]acpower\[aq] statistics collector reads
SUT power consumption for the last second every second, and
\[aq]turbostat\[aq] default interval is 5 seconds.
Use \[aq]acpower:5,turbostat:10\[aq] to increase the intervals to 5 and
10 seconds correspondingly.
Use the \[aq]--list-stats\[aq] to get the default interval values.
.TP
\f[B]--list-stats\f[R]
Print information about the statistics \[aq]ndl\[aq] can collect and
exit.
.TP
\f[B]-l\f[R] \f[I]LDIST\f[R], \f[B]--ldist\f[R] \f[I]LDIST\f[R]
The launch distance in microseconds.
This tool works by scheduling a delayed network packet, then sleeping
and waiting for the packet to be sent.
This step is referred to as a \[dq]measurement cycle\[dq] and it is
usually repeated many times.
The launch distance defines how far in the future the delayed network
packets are scheduled.
By default this tool randomly selects launch distance in range of [5000,
50000] microseconds (same as \[aq]--ldist 5000,50000\[aq]).
Specify a comma-separated range or a single value if you want launch
distance to be precisely that value all the time.
The default unit is microseconds, but you can use the following
specifiers as well: ms - milliseconds, us - microseconds, ns -
nanoseconds.
For example, \[aq]--ldist 500us,100ms\[aq] would be a [500,100000]
microseconds range.
Note, too low values may cause failures or prevent the SUT from reaching
deep C-states.
The optimal value is system-specific.
.TP
\f[B]--cpu\f[R] \f[I]CPU\f[R]
The CPU number to bind the helper to.
The helper will use this CPU to send delayed packets.
In normal conditions this means that network packet buffers will be
allocated on the NUMA node local to the CPU, but not necessarily local
to the network card.
Use this option to measure different packet memory locations on a NUMA
system.
Special value \[aq]local\[aq] can be used to specify a CPU with lowest
CPU number local to the NIC, and this is the default value.a Special
value
.TP
\f[B]--exclude\f[R] \f[I]EXCLUDE\f[R]
Datapoints to exclude: remove all the datapoints satisfying the
expression \[aq]EXCLUDE\[aq].
Here is an example of an expression: \[aq](WakeLatency < 10000) | (PC6%
< 1)\[aq].
This filter expression will remove all datapoints with
\[aq]WakeLatency\[aq] smaller than 10000 nanoseconds or package C6
residency smaller than 1%.
You can use any metrics in the expression.
.TP
\f[B]--include\f[R] \f[I]INCLUDE\f[R]
Datapoints to include: remove all datapoints except for those satisfying
the expression \[aq]INCLUDE\[aq].
In other words, this option is the inverse of \[aq]--exclude\[aq].
This means, \[aq]--include expr\[aq] is the same as \[aq]--exclude
\[dq]not (expr)\[dq]\[aq].
.TP
\f[B]--keep-filtered\f[R]
If the \[aq]--exclude\[aq] / \[aq]--include\[aq] options are used, then
the datapoints not matching the selector or matching the filter are
discarded.
This is the default behavior which can be changed with this option.
If \[aq]--keep-filtered\[aq] has been specified, then all datapoints are
saved in result.
Here is an example.
Suppose you want to collect 100000 datapoints where RTD is greater than
50 microseconds.
In this case, you can use these options: -c 100000 --exclude=\[dq]RTD >
50\[dq].
The result will contain 100000 datapoints, all of them will have RTD
bigger than 50 microseconds.
But what if you do not want to simply discard the other datapoints,
because they are also interesting?
Well, add the \[aq]--keep-filtered\[aq] option.
The result will contain, say, 150000 datapoints, 100000 of which will
have RTD value greater than 50.
.TP
\f[B]--report\f[R]
Generate an HTML report for collected results (same as calling
\[aq]report\[aq] command with default arguments).
.TP
\f[B]--force\f[R]
By default a network card is not accepted as a measurement device if it
is used by a Linux network interface and the interface is in an active
state, such as \[dq]up\[dq].
Use \[aq]--force\[aq] to disable this safety mechanism.
Use it with caution.
.TP
\f[B]--trash-cpu-cache\f[R]
Trash CPU cache to make sure NIC accesses memory when measuring latency.
Without this option, there is a change the data NIC accesses is in a CPU
cache.
With this option, ndl allocates a buffer and fills it with data every
time a delayed packet is scheduled.
Supposedly, this should push out cached data to the memory.
By default, the CPU cache trashing buffer size a sum of sizes of all
caches on all CPUs (includes all levels, excludes instruction cache).
.TP
\f[B]--freq-noise\f[R] \f[I]FREQ_NOISE\f[R]
Add frequency scaling noise to the measured system.
This runs a background process that repeatedly modifies CPU or uncore
frequencies for given domains.
The reason for doing this is because frequency scaling is generally an
expensive operation and is known to impact system latency.
\[aq]FREQ_NOISE\[aq] is specified as \[aq]TYPE:ID:MIN:MAX\[aq], where:
TYPE should be \[aq]cpu\[aq] or \[aq]uncore\[aq], specifies whether CPU
or uncore frequency should be modified; ID is either CPU number or
uncore domain ID to modify the frequency for (e.g.
\[aq]cpu:12:...\[aq] would target CPU12); MIN is the minimum CPU/uncore
frequency value; MAX is the maximum CPU/uncore frequency value.
For example, to add frequency scaling noise for CPU0, add \[aq]--
freq-noise cpu:0:min:max\[aq].
To add uncore frequency noise for uncore domain 0, add \[aq]--freq-noise
uncore:0:min:max\[aq].
The parameter can be added multiple times to specify multiple frequency
noise domains.
.TP
\f[B]--freq-noise-sleep\f[R] \f[I]FREQ_NOISE_SLEEP\f[R]
Sleep between frequency noise operations.
This time is added between every frequency scaling operation executed by
the \[aq]freq-noise\[aq] feature.
The default time unit is microseconds, but it is possible to use time
specifiers as well, ms - milliseconds, us - microseconds, ns -
nanoseconds.
Default sleep time is 50ms.
